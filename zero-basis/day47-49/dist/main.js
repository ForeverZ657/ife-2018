!function(e){var t={};function n(r){if(t[r])return t[r].exports;var u=t[r]={i:r,l:!1,exports:{}};return e[r].call(u.exports,u,u.exports,n),u.l=!0,u.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:r})},n.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=14)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,u=n(1),o=(r=u)&&r.__esModule?r:{default:r};function a(e){document.querySelector(".cash").innerHTML="Cash: "+e.getCash()}function i(e){document.querySelector(".waiting-num").innerHTML="Waiting: "+e}t.default={wait:function(e){return new Promise(function(t){return setTimeout(t,e*o.default.timeUnit)})},move:function(e,t,n){var r=document.getElementById(e.id);"hor"===t?r.style.left=n+"px":r.style.top=n+"px"},renderDishList:function(e,t){var n=void 0;switch(e){case"kitchen":n=document.querySelector(".kitchen .dish-list");break;case"dining":n=document.querySelector(".dining-area .dish-list")}for(;n.firstChild;)n.removeChild(n.firstChild);t.forEach(function(e){var t=document.createElement("li");t.innerHTML=e.name,n.appendChild(t)})},startCountdown:function(e,t,n){e=e*o.default.timeUnit/1e3;var r=document.querySelector(t);!function t(){r.innerHTML=n+" ("+e--+"s)",e>0&&setTimeout(t,1e3)}()},initView:function(e){var t=!0,n=!1,r=void 0;try{for(var u,c=e.staff[Symbol.iterator]();!(t=(u=c.next()).done);t=!0){var f=u.value;switch(f.type){case"COOK":var l=new Image;l.src=f.img,document.querySelector(".kitchen").appendChild(l);break;case"WAITER":var s=new Image;s.src=f.img,s.style.transitionDuration=o.default.timeUnit/2/1e3+"s",s.setAttribute("id",f.id),document.querySelector(".dining-area").appendChild(s)}}}catch(e){n=!0,r=e}finally{try{!t&&c.return&&c.return()}finally{if(n)throw r}}var d=!0,h=!1,y=void 0;try{for(var m,p=e.customerQueue[Symbol.iterator]();!(d=(m=p.next()).done);d=!0){var v=m.value,b=new Image;b.src=v.img,b.style.transitionDuration=o.default.timeUnit/2/1e3+"s",b.setAttribute("id",v.id),document.querySelector(".waiting-area").appendChild(b)}}catch(e){h=!0,y=e}finally{try{!d&&p.return&&p.return()}finally{if(h)throw y}}a(e),i(e.customerQueue.length)},updateCash:a,updateLog:function(e){var t=document.createElement("p");t.innerHTML=e;var n=document.querySelector(".log");n.appendChild(t),n.scrollTop=n.scrollHeight},updateWaitingNum:i}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={timeUnit:1e3}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var u=function(){function e(t){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),new.target===e)throw new Error("You cannot instantiate an abstract class!");this.id=Math.random().toString(36).substr(2,16),this.name=t.name,this.salary=t.salary,this.img=t.img}return r(e,[{key:"work",value:function(){throw new Error("You cannot call an abstract method!")}}]),e}();t.default=u},function(e,t,n){e.exports=n.p+"5e3120f346f16d449192cc4a369a7810.png"},function(e,t,n){e.exports=n.p+"e880c6a8c20c8bab6781b0cc0fe5b7da.png"},function(e,t,n){e.exports=n.p+"8f07ad3c38516e341a0b85068c703703.png"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.name=t.name,this.cost=t.cost,this.price=t.price,this.time=t.time}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=o(n(0));o(n(1));function o(e){return e&&e.__esModule?e:{default:e}}var a=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.id=Math.random().toString(36).substr(2,16),this.name=t.name,this.img=t.img}return r(e,[{key:"order",value:function(e){var t=this;return u.default.startCountdown(3,".dining-area .status","ordering"),u.default.wait(3).then(function(){for(var n=Math.floor(4*Math.random())+1,r=[];n--;){var o=Math.floor(Math.random()*e.length);r.push(e[o]),e.splice(o,1)}return t.setStatus(""),u.default.updateLog(t.name+": I want to order "+r.map(function(e){return e.name})),u.default.renderDishList("dining",r),r})}},{key:"eat",value:function(){u.default.updateLog(this.name+": (finished eating..) Very delicious!")}},{key:"setStatus",value:function(e){document.querySelector(".dining-area .status").innerHTML=e}}]),e}();t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=i(n(2)),a=i(n(0));function i(e){return e&&e.__esModule?e:{default:e}}function c(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var f=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=c(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.type="WAITER","object"===r(t.instance)?c(n,t.instance):(t.instance=n,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default),u(t,[{key:"work",value:function(e){var t=this;if(e&&e.constructor===Array)return a.default.updateLog("Waiter: We will serve you as soon as possible. (Leaving...)"),a.default.move(this,"hor",-250),a.default.wait(.5).then(function(){return{dishList:e,waiter:t}});a.default.move(this,"hor",150),a.default.wait(.5).then(function(){a.default.updateLog("Waiter: This is your order. Enjoy!"),e?(a.default.move(t,"hor",100),a.default.wait(.5).then(function(){a.default.updateLog("Collecting money..."),t.bye()})):a.default.move(t,"hor",-250)})}},{key:"welcome",value:function(e){return a.default.move(e,"hor",-150),a.default.move(this,"hor",150),a.default.wait(.5).then(function(){return a.default.updateLog("Waiter: Hello "+e.name+". Welcome to our restaurant. What would you like to eat?"),e})}},{key:"bye",value:function(){var e=document.querySelector(".waiting-area"),t=document.querySelectorAll(".waiting-area img");e.removeChild(t[0]),a.default.renderDishList("dining",[]),a.default.updateLog("Waiter: I hope you enjoyed your meal. Have a nice day! Bye~ (Cleaning...)")}}]),t}();t.default=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=i(n(2)),a=i(n(0));i(n(1));function i(e){return e&&e.__esModule?e:{default:e}}function c(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var f=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=c(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.status="free",n.type="COOK","object"===r(t.instance)?c(n,t.instance):(t.instance=n,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default),u(t,[{key:"work",value:function(e){var t=this;return this.setStatus("busy"),a.default.renderDishList("kitchen",e.dishList.slice(1)),e.dishList.reduce(function(n,r,u,o){return n.then(function(){return a.default.startCountdown(r.time,".kitchen .status","cooking "+r.name),a.default.wait(r.time).then(function(){a.default.updateLog("Cook: "+r.name+" cooked."),a.default.renderDishList("kitchen",o.slice(u+2));var n=u===o.length-1;n&&t.setStatus("free"),e.waiter.work(n)})})},Promise.resolve())}},{key:"setStatus",value:function(e){document.querySelector(".kitchen .status").innerHTML=e}}]),t}();t.default=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(0),a=(r=o)&&r.__esModule?r:{default:r};var i=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.cash=t.cash,this.seats=t.seats,this.staff=t.staff,this.customerQueue=t.customerQueue}return u(e,[{key:"hire",value:function(e){this.staff.push(e),this.cash-=e.salary}},{key:"fire",value:function(e){this.staff.splice(this.staff.indexOf(e),1),this.cash+=e.salary}},{key:"nextCustomer",value:function(){return a.default.updateWaitingNum(this.customerQueue.length-1),this.customerQueue.shift()}},{key:"addCash",value:function(e){this.cash+=e}},{key:"getCash",value:function(){return this.cash}},{key:"updateCash",value:function(e){var t=this;return e.forEach(function(e){t.addCash(e.price-e.cost)}),e}}]),e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=f(n(10)),o=f(n(9)),a=f(n(8)),i=f(n(7)),c=f(n(6));function f(e){return e&&e.__esModule?e:{default:e}}var l=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return r(e,null,[{key:"getInstance",value:function(e,t){switch(e){case this.RESTAURANT:return new u.default(t);case this.COOK:return new o.default(t);case this.WAITER:return new a.default(t);case this.CUSTOMER:return new i.default(t);case this.DISH:return new c.default(t);default:throw new Error("Unknown object type.")}}},{key:"RESTAURANT",get:function(){return 0}},{key:"COOK",get:function(){return 1}},{key:"WAITER",get:function(){return 2}},{key:"CUSTOMER",get:function(){return 3}},{key:"DISH",get:function(){return 4}}]),e}();t.default=l},,function(e,t,n){},function(e,t,n){"use strict";n(13);var r=c(n(11)),u=c(n(5)),o=c(n(4)),a=c(n(3)),i=c(n(0));function c(e){return e&&e.__esModule?e:{default:e}}c(n(1)).default.timeUnit=1e3;var f=r.default.getInstance(r.default.RESTAURANT,{cash:1e4,seats:20,staff:[],customerQueue:[]}),l=r.default.getInstance(r.default.COOK,{name:"Ramsay",salary:4e3,img:u.default}),s=r.default.getInstance(r.default.WAITER,{name:"Cinderella",salary:1e3,img:o.default});f.hire(l),f.hire(s);var d=[r.default.getInstance(r.default.DISH,{name:"Sweet and Sour Pork",cost:50,price:100,time:3}),r.default.getInstance(r.default.DISH,{name:"Kung Pao Chicken",cost:40,price:80,time:4}),r.default.getInstance(r.default.DISH,{name:"Ma Po Tofu",cost:30,price:60,time:3}),r.default.getInstance(r.default.DISH,{name:"Dumplings",cost:35,price:70,time:3}),r.default.getInstance(r.default.DISH,{name:"Spring Rolls",cost:20,price:50,time:3}),r.default.getInstance(r.default.DISH,{name:"Peking Roasted Duck",cost:100,price:200,time:5})];function h(){0!==f.customerQueue.length?s.welcome(f.nextCustomer()).then(function(e){return e.order(d.slice())}).then(function(e){return f.updateCash(e)}).then(function(e){return s.work(e)}).then(function(e){return l.work(e)}).then(function(){return i.default.wait(2)}).then(function(){return i.default.updateCash(f)}).then(h):document.querySelector(".reset").style.display="block"}f.customerQueue=[r.default.getInstance(r.default.CUSTOMER,{name:"David",img:a.default}),r.default.getInstance(r.default.CUSTOMER,{name:"Tom",img:a.default}),r.default.getInstance(r.default.CUSTOMER,{name:"Lily",img:a.default}),r.default.getInstance(r.default.CUSTOMER,{name:"Robert",img:a.default})],i.default.initView(f),document.querySelector(".start").addEventListener("click",function(){return h()}),document.querySelector(".reset").addEventListener("click",function(){return location.reload()})}]);